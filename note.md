To enhance the AuthService to use 2FA across multi-device scenarios, the code is updated to improve the state management, properly generate the 6-digit code, safely handle multi-device storage, validate the inputs, and adjust the failure count's logic.

Here is the updated code:
